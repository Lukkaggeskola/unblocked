function LoginManager(){}LoginManager.prototype.init=function(){var a=document.getElementsByClassName("gamearter-login-button");if("undefined"!=typeof a[0]){var b=a[0];b.style.display="inline-block",b.style.lineHeight="1px",b.setAttribute("data-id","ga-loginbutton-1");var c=document.createElement("iframe");c.setAttribute("id","ga-loginbutton-1"),c.setAttribute("class","ga-loginbutton"),c.setAttribute("title","Show login dialog"),c.style.overflow="hidden",c.style.border="none","https://www.pacogames.com"===document.location.origin&&-1===document.location.pathname.indexOf("/index.php")?(c.setAttribute("src","https://auth.gamearter.com/button?cb=ga-loginbutton-1&type=pacogames&size=large"),c.style.width=1e3<window.screen.width?"171px":"85px",c.style.height=1e3<window.screen.width?"50px":"44px",b.appendChild(c),window.addEventListener("message",glm.receiveMessage)):(console.log("game - connector req"),glm.ajaxPost("https://auth.gamearter.com/connector",b.dataset,function(a){"object"==typeof a&&"ifrm"in a?(c.setAttribute("src",a.ifrm.src),c.style.width=a.ifrm.width,c.style.height=1e3<window.screen.width?a.ifrm.height:"44px",b.appendChild(c),window.addEventListener("message",glm.receiveMessage)):glm.error(a)}))}},LoginManager.prototype.warn=function(...a){},LoginManager.prototype.error=function(...a){console.error.apply(this,a)},LoginManager.prototype.log=function(...a){},LoginManager.prototype.receiveMessage=function(a){if("https://auth.gamearter.com"===a.origin){console.log("receve msg:",a);try{data=JSON.parse(a.data)}catch(b){data=a.data}if(glm.warn("[connector] message from "+a.origin,data),"dialog"in data&&"open"===data.dialog){if(null!==document.getElementById("glm-dialog"))return void glm.error("DIALOG already exists");var b=document.createElement("iframe");if(b.setAttribute("src","https://auth.gamearter.com"),b.id="glm-dialog",b.style.border="none",b.style.position="absolute",b.style.top="50%",b.style.left="50%",b.style.msTransform="translate(-50%,-50%)",b.style.webkitTransform="translate(-50%,-50%)",b.style.transform="translate(-50%,-50%)",b.style.maxHeight="600px",!0===data.overlayListener){var c=document.createElement("div");c.id="gasso",c.style.width="100%",c.style.height="100%",c.style.position="fixed",c.style.top="0",c.style.left="0",c.style.right="0",c.style.bottom="0",c.style.zIndex="2147483646",c.style.backgroundColor="rgba(0,0,0,0.8)",document.body.style.overflow="hidden",document.getElementsByTagName("html")[0].style.overflow="hidden",nww=1e3,nwh=677,b.style.width=nww+"px",b.style.height=nwh+"px",b.style.boxShadow="0px 0px 20px rgba(255,255,255,.25)",document.body.appendChild(c),c.appendChild(b),c.addEventListener("click",glm.closeOverlayWindow),window.addEventListener("keydown",glm.keyEvent)}else{var c=document.createElement("div");c.id="gasso",c.style.width="100%",c.style.height="100%",c.style.position="fixed",c.style.backgroundColor="rgba(23,23,23,.7)",c.style.zIndex=21e4,b.style.width="100%",b.style.height="677px",c.appendChild(b);var d=document.querySelector("[data-id=\"ga-loginbutton-1\"]");null!==d&&(d.parentNode.insertBefore(c,d),"template"in data&&(glm.template={template:data.template,game:data.game,cross:data.cross}))}!0===data.resizeListener&&(setTimeout("glm.resizeEvent();",500),window.addEventListener("resize",glm.resizeEvent))}else if("getTemplate"in data)glm.log("connect.js 180"),document.getElementById("glm-dialog").contentWindow.postMessage(glm.template,"https://auth.gamearter.com");else if("getLocation"in data)parts=window.location.pathname.split("/"),glm.log("connect.js 188"),document.getElementById("glm-dialog").contentWindow.postMessage({setLocation:{gamefolder:"webgl"===parts[1]||"html5"===parts[1]||"game"===parts[1]||"m"===parts[1]?parts[2]:null,urlAddress:window.location.href}},"https://auth.gamearter.com");else if("getDimensions"in data)document.getElementById("gasso").offsetHeight<document.body.clientHeight&&(document.getElementById("glm-dialog").style.height=600<document.body.clientHeight?"600px":document.body.clientHeight+"px");else if("setDimensions"in data&&0<data.setDimensions.height)document.getElementById("glm-dialog").style.height=data.setDimensions.height+"px",document.getElementById("glm-dialog").style.width=data.setDimensions.width+"px";else if("user"in data&&"uid"in data.user)glm.log("given name: "+data.user.nick),"window"in data&&"close"===data.window&&glm.closeOverlayWindow(),callbacks=document.querySelector("[data-id=\"ga-loginbutton-1\"]").dataset.callback.split(","),glm.runCallbacks(callbacks,{action:"log-in",data:data.user});else if("logout"in data)callbacks=document.querySelector("[data-id=\"ga-loginbutton-1\"]").dataset.callback.split(","),glm.runCallbacks(callbacks,{action:"log-out",data:{}});else if("iframe"in data){var e=document.getElementById(data.iframe.id);e.style.width=1e3<window.screen.width?data.iframe.width:"85px"}else if("template"in data){var e=document.getElementById("glm-dialog");glm.log("connect.js 248"),e.contentWindow.postMessage(data,"https://auth.gamearter.com")}else"dialog"in data&&"close"===data.dialog?glm.closeOverlayWindow():"dialog"in data&&"closex"===data.dialog&&glm.closeOverlayWindow()}},LoginManager.prototype.runCallbacks=function(a,b){for(i=0;i<a.length;i++)if(glm.warn("CALLBACK "+a[i],b),1<a[i].indexOf(".")){parts=a[i].split(".");for(var c=window[parts[0]],d=1;d<parts.length;d++)c=c[parts[d]];c.apply(window,[b])}else window[a[i]](b)},LoginManager.prototype.closeOverlayWindow=function(){window.removeEventListener("keydown",glm.keyEvent),window.removeEventListener("resize",glm.resizeEvent);var a=document.getElementById("glm-dialog");null!==a&&a.parentNode.removeChild(a);var a=document.getElementById("gasso");if(null!==a){a.removeEventListener("click",glm.closeOverlayWindow),a.style.opacity=1;var b=setInterval(function(){fade(a)&&(null!==a.parentNode&&a.parentNode.removeChild(a),clearInterval(b),document.body.style.overflow="",document.getElementsByTagName("html")[0].style.overflow="")},5)}},LoginManager.prototype.resizeEvent=function(){maxw=1e3,maxh=677;var a=document.getElementById("glm-dialog");nww=a.clientWidth,nwh=a.clientHeight;var b=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,c=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;nwh>c?nwh=c-20:nwh<maxh&&c>maxh?nwh=maxh:nwh<maxh&&c<maxh&&(nwh=c-20),a.style.height=nwh+"px",nww>b?nww=b-40:nwh<maxw&&b>maxw?nww=maxw:nwh<maxw&&b<maxw&&(nww=b-40),a.style.width=nww+"px"},LoginManager.prototype.keyEvent=function(a){a=a||window.event,"key"in a&&("Escape"===a.key||"Esc"===a.key)?glm.closeOverlayWindow():27===a.keyCode&&glm.closeOverlayWindow()},LoginManager.prototype.parse=function(a){try{return JSON.parse(a)}catch(b){return a}},LoginManager.prototype.xhr=function(a,b,c,d){var e=new XMLHttpRequest;return e.open(a,b,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"===a&&e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&(200===e.status?d.success(glm.parse(e.responseText)):glm.error(glm.parse(e.responseText)))},e.send(c),c},LoginManager.prototype.ajax=function(a,b,c,d){return glm.xhr(a,b,c,{success:d})},LoginManager.prototype.ajaxGet=function(a,b){return glm.xhr("GET",a,void 0,{success:b})},LoginManager.prototype.ajaxPost=function(a,b,c){var d=[];for(var e in b)d.push(encodeURIComponent(e)+"="+encodeURIComponent(b[e]));return glm.xhr("POST",a,d.join("&"),{success:c})};function fade(a){return a.style.opacity-=.2,!!(.1>a.style.opacity)}var glm=new LoginManager;glm.init();