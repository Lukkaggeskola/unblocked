import{openCaseNavigateAway as e}from"/js/opencase.js?v=2.0.b16";import{items as t,onload as o}from"/data/items.js?v=2.0.b16";import"/js/inputs.js?v=2.0.b16";import"/js/tips.js?v=2.0.b16";import"/js/welcome.js?v=2.0.b16";import"/js/sessions.js?v=2.0.b16";import"/js/online/profile.js?v=2.0.b16";import"/js/online/leaderboard.js?v=2.0.b16";import"/js/online/coinflip.js?v=2.0.b16";import"/js/online/gifts.js?v=2.0.b16";import{getItem as a,itemQualities as r,removeItemsFromInventory as l,renderItem as n,selectItems as i}from"/js/items.js?v=2.0.b16";import s from"/js/select.js?v=2.0.b16";import{game as c}from"/js/game.js?v=2.0.b16";import{addStat as u}from"/js/achievements.js?v=2.0.b16";import{generateConvlr as d}from"/js/itemsn.js?v=2.0.b16";if(!localStorage.flags)localStorage.flags="";o().then((()=>{setTimeout((()=>{document.body.classList.add("data-loaded");d();showPage("welcome");c.emit("update");s("#floating-item-example").appendChild(n(t["StatTrak USP-S | Neo-Noir (Factory New)"]));for(let e=user.inventory.length-1;e>=0;e--){let o=user.inventory[e];if(o===null){console.log("AY");user.inventory.splice(e,1);continue}let l=a(o);if(l.masterItem){user.inventory.splice(e,1);user.inventory.push(`${l.short} (${r[l.qualities[0]]})`)}else if(!t[o]){let l=o.replace("(Factory New)","").replace("(Minimal Wear)","").replace("(Field-Tested)","").replace("(Well-Worn)","").replace("(Battle-Scarred)","").trim();let n=l.startsWith("StatTrak");let i=l.startsWith("Souvenir");l=l.replace("Souvenir","").replace("StatTrak","").trim();if(t[l]){let t=a(l);if(t.qualities[0]===undefined)console.log(t);let o=`${t.short} (${r[t.qualities[0]]||"Vanilla"})`;if(n&&t.stattrakAvailable)o="StatTrak "+o;if(i&&t.souvenirAvailable)o="Souvenir "+o;user.inventory.splice(e,1);user.inventory.push(o)}else console.log("ITEM DOESN'T EXIST ANYMORE",o,l)}}}),500)}));import("/js/coinflip.js?v=2.0.b16");import("/js/jackpot.js?v=2.0.b16");import("/js/crash.js?v=2.0.b16");import("/js/mines.js?v=2.0.b16");import("/js/click.js?v=2.0.b16");import("/js/inventory.js?v=2.0.b16");import("/js/shop.js?v=2.0.b16");import("/js/upgrades.js?v=2.0.b16");import("/js/inspectItem.js?v=2.0.b16");import("/js/lucky.js?v=2.0.b16");import("/js/stats.js?v=2.0.b16");import("/js/missions.js?v=2.0.b16");import("/js/collection.js?v=2.0.b16");import("/js/tradeup.js?v=2.0.b16");let g=false;if(window.location.hostname==="localhost"){g=true;document.body.classList.add("dev");document.title="(Development) Case Clicker 2 - MTSL"}export let currentPage="";let p=[];export function showPage(t,o,a,r,l){document.body.focus();let n=t.split("$")[0];let i=t.split("$")[1];currentPage=t;if(p[p.length-1]===null)p.pop();if(!o)p.push(currentPage);else if(!a)p.push(null);if(!r)c.emit("update",true);let s=document.querySelectorAll("[page]");for(let e=0;e<s.length;e++)s[e].classList.remove("show");let u=document.querySelectorAll("[nbtn]");for(let e=0;e<u.length;e++){u[e].classList.remove("active");if(u[e].getAttribute("nbtn")===n)u[e].classList.add("active")}if(p[p.length-2]==="opencase")e();c.emit("showPage",{page:n,data:i,direct:l});if(!n)return;let d=document.querySelector("[page="+n+"]");if(!d)return;d.classList.add("show");if(d.onshow)d.onshow()}export let user={money:240,tickets:0,tokens:0,xp:0,stats:{creation:(new Date).getTime()},inventory:["Spectrum Case"],upgrades:{},achievements:{},achievements_collected:{},luckyWheelWins:[]};if(g)window.getUser=()=>user;function m(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function e(t,o){return String.fromCharCode("0x"+o)}))}function f(e){return decodeURIComponent(e.split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function h(e){e=m(e);let t={};let o=(e+"").split("");let a=[];let r;let l=o[0];let n=256;for(let e=1;e<o.length;e++){r=o[e];if(t[l+r]!=null)l+=r;else{a.push(l.length>1?t[l]:l.charCodeAt(0));t[l+r]=n;n++;l=r}}a.push(l.length>1?t[l]:l.charCodeAt(0));return a.map((e=>{let t=e.toString(36);return t.substring(0,t.length-1)+(t[t.length-1].match(/[0-9]/)?v[t[t.length-1]]:t[t.length-1].toUpperCase())})).join("")}window.lzw_encode=h;let v={0:"=",1:"!",2:"?",3:"$",4:"%",5:"&",6:"/",7:"\\",8:"-",9:"+"};let S={"=":"0","!":"1","?":"2",$:"3","%":"4","&":"5","/":"6","\\":"7","-":"8","+":"9"};let w=Object.keys(S).join("");function y(e){let t=[];let o="";for(let a=0;a<e.length;a++){let r=e[a];if(r.match(/[A-Z]/)||w.includes(r)){o+=w.includes(r)?S[r]:r.toLowerCase();t.push(parseInt(o,36));o=""}else{o+=r}}let a={};let r=String.fromCharCode(t[0]);let l=r;let n=[r];let i=256;let s;for(let e=1;e<t.length;e++){let o=t[e];if(o<256)s=String.fromCharCode(t[e]);else s=a[o]?a[o]:l+r;n.push(s);r=s[0];a[i]=l+r;i++;l=s}return f(n.join(""))}function b(e){let t={};let o=(e+"").split("");let a=o[0];let r=a;let l=[a];let n=256;let i;for(let e=1;e<o.length;e++){let s=o[e].charCodeAt(0);if(s<256)i=o[e];else i=t[s]?t[s]:r+a;l.push(i);a=i.charAt(0);t[n]=r+a;n++;r=i}return l.join("")}function I(){return h(JSON.stringify(user))}function j(e){try{if(e==="1"){localStorage.v1SaveSnapshot=localStorage.localsave;let e=b(localStorage.localsave).split("").map((e=>e.charCodeAt(0)-1));let t=new TextDecoder;return JSON.parse(t.decode(new Uint8Array(e)))}else if(e==="2"){return JSON.parse(y(localStorage.localsave))}}catch(e){console.error(e);delete localStorage._cbid;return user}}if(localStorage.localsave)user=j(localStorage.lsver||"1");if(!localStorage.localuser)localStorage.localuser=(new Date).getTime().toString(36)+"."+Math.floor(Math.random()*36**11).toString(36);function k(){if(window.disableSaving)return;try{if(P)return;let e=I();localStorage.lsver="2";if(e)localStorage.localsave=e}catch(e){alert("An error occurred doing auto save. Please report it via the discord server! --- "+e+" - LSL:"+(localStorage.localsave?.length||0)+" - GOL:"+JSON.stringify(user).length)}}window.onbeforeunload=()=>k();setInterval((()=>k()),1e4);let P=false;window.wipeSave=function(){P=true;delete localStorage._cbid;delete localStorage.localsave;delete localStorage.shop;delete localStorage.flags;delete localStorage.backup;delete localStorage.backupid;window.location.reload()};if(localStorage.backupid&&localStorage.backupid!==localStorage._cbid){document.getElementById("recover-btn").style.display="initial";document.getElementById("dismiss-recover-btn").style.display="initial";document.getElementById("recover-btn").onclick=()=>{if(confirm("Do you want to recover your old save? The current save will be lost.")){P=true;localStorage._cbid=localStorage.backupid;localStorage.localsave=localStorage.backup;window.location.reload()}};document.getElementById("dismiss-recover-btn").onclick=()=>{if(confirm("Are you sure?")){delete localStorage.backup;delete localStorage.backupid;localStorage._cbid=localStorage.localuser;document.getElementById("recover-btn").style.display="none";document.getElementById("dismiss-recover-btn").style.display="none"}}}let T=["Recruit","Private I","Private II","Private III","Private IV","Corporal I","Corporal II","Corporal III","Corporal IV","Sergeant I","Sergeant II","Sergeant III","Sergeant IV","Master Sergeant I","Master Sergeant II","Master Sergeant III","Master Sergeant IV","Sergeant Major I","Sergeant Major II","Sergeant Major III","Sergeant Major IV","Lieutenant I","Lieutenant II","Lieutenant III","Lieutenant IV","Captain I","Captain II","Captain III","Captain IV","Major I","Major II","Major III","Major IV","Colonel I","Colonel II","Colonel III","Brigadier General","Major General","Lieutenant General","General","Global General"];const L=.1;export function getPlayerLevel(){let e=0;function t(){let o=Math.round(e**(L*e+1)*1e3);let a=Math.round((e+1)**(L*(e+1)+1)*1e3);if(a<=user.xp&&e<40){++e;return t()}else return{level:e,xps:o,xpa:user.xp-o,xpp:(user.xp-o)/(a-o),xpn:a-o}}return t()}c.on("update",(e=>{s("#money").innerText=numToString(user.money/100,2)+"€";s("#tickets").innerText=numToString(user.tickets);s("#tokens").innerText=numToString(user.tokens);s("#level-bar-text-left").innerText=numToString(getPlayerLevel().xpa)+"/"+numToString(getPlayerLevel().xpn)+" xp";s("#level-bar-text-right").innerText="level "+getPlayerLevel().level;s("#level-bar-p").style.width=getPlayerLevel().xpp*100+"%";s("#level-image").style.backgroundImage='url("images/level '+getPlayerLevel().level+'.png")';s("#level-title").innerText=T[getPlayerLevel().level];Array.from(document.querySelectorAll("[display]")).forEach((e=>{switch(e.getAttribute("display")){case"tokens":e.innerText=numToString(user.tokens)+" coins";break}}));if(!e)showPage(currentPage,true,false,false,true)}));export function numToString(e,t=0){e=Math.floor(e*10**t)/10**t;if(e<1e4)return e.toFixed(t);else if(e<1e6)return e<1e5?Math.floor(e/10)/100+"k":Math.floor(e/100)/10+"k";else if(e<1e9)return e<1e7?Math.floor(e/1e4)/100+"m":Math.floor(e/1e5)/10+"m";else if(e<1e12)return Math.floor(e/1e8)/10+"t";else if(e<1e15)return Math.floor(e/1e11)/10+"q"}document.onmousedown=e=>{if(!e.path)e.path=e.composedPath();for(let t=0;t<e.path.length-2;t++)if(e.path[t].classList.contains("dropdown"))return;for(let e=0;e<s(".dropdown").length;e++)s(".dropdown")[e].classList.remove("show");Array.from(document.getElementsByClassName("js-dropdown")).forEach((e=>{document.body.removeChild(e)}))};export function goToPreviousPage(){if(p.length>1){p.pop();showPage(p[p.length-1],true,true)}}let C=document.querySelectorAll("[showpage]");for(let e=0;e<C.length;e++)C[e].onclick=()=>showPage(C[e].getAttribute("showpage"));export async function tradeIn(){const e=await i();e.forEach((e=>user.tokens+=e.price/10));l(e.map((e=>e.name)));c.emit("update");goToPreviousPage()}function x(e){e=parseInt(e);for(let e=1;e<=3;e++)document.body.classList.remove("graphics-level-"+e);for(let t=1;t<=e;t++)document.body.classList.add("graphics-level-"+t);localStorage.graphicsLevel=e;window.graphicsLevel=e;s("#current-graphic-level").innerText=["Super Low","Low","Medium","Ultra"][e]}x(localStorage.graphicsLevel||1);window.setGraphicsLevel=x;export function setAlwaysCompact(e){e=e+""==="true";localStorage.compactMode=e;window.alwaysCompact=e;M()}setAlwaysCompact(localStorage.compactMode||false);window.setAlwaysCompact=setAlwaysCompact;window.addEventListener("touchstart",(function(e){if(e.target.tagName!=="BUTTON"&&e.target.classList.contains("item")){e.preventDefault()}}),{passive:false});window.addEventListener("keydown",(e=>{if(e.key==="Escape")goToPreviousPage()}));window.addEventListener("resize",(()=>c.emit("update")));window.addEventListener("resize",(()=>M()));function M(){if(window.innerHeight<=850||window.innerWidth<=1150){s("#toggle-compact").innerText="Compact is enabled by default due to screen resolution";s("#toggle-compact").disabled=true}else{s("#toggle-compact").innerText="Toggle Compact";s("#toggle-compact").disabled=false}document.body.classList.toggle("compact",window.innerHeight<=850||window.innerWidth<=1150||alwaysCompact);document.body.classList.toggle("natural-compact",window.innerHeight<=850||window.innerWidth<=1150)}M();setInterval((()=>{user.money+=user.upgrades.passiveIncome||0;u("earned_cash",user.upgrades.passiveIncome||0);c.emit("update",true)}),1e3);setInterval((()=>{localStorage.lastSeen=Math.floor((new Date).getTime()/1e3).toString(36)}),1e3);function A(e,t){let o=Math.min(t,user.upgrades.offlineBank||7500);const a=document.body.q(".dialog-overlay");a.q(".floating-dialog",{c:[q(".floating-dialog-header",{c:[q(".floating-dialog-title","Offline Earnings"),q(".floating-dialog-close",{onclick(){document.body.removeChild(a)}})]}),q(".floating-dialog-body",{c:[q(".floating-dialog-text",`Welcome back! You have earned ${(o/100).toFixed(2)} € while being offline!`),o<t&&q(".floating-dialog-text",`But if your offline bank capacity was higher, you could have earned ${(t/100).toFixed(2)} €...`)]})]})}function E(){let e=Math.ceil((new Date).getTime()/1e3)-parseInt(localStorage.lastSeen,36);let t=Math.floor((user.upgrades.passiveIncome||0)*((user.upgrades.offlineIncome||0)/100)*e);if(t>100){A(e,t);user.money+=Math.min(t,user.upgrades.offlineBank||7500);u("earned_cash",Math.min(t,user.upgrades.offlineBank||7500));c.emit("update")}}E();setTimeout((()=>c.emit("update")),100);document.body.classList.add("game-ready");setInterval((()=>{if(!user.seasonTimePlayed)user.seasonTimePlayed=0;user.seasonTimePlayed+=1;u("time_played",1)}),1e3);window.addEventListener("keydown",(e=>{if(document.activeElement.tagName==="INPUT")return;if(currentPage!=="click"&&e.key==="e")showPage("click");if(currentPage!=="shop"&&e.key==="s")showPage("shop");if(currentPage!=="betting"&&e.key==="g")showPage("betting");if(currentPage!=="upgrades"&&e.key==="u")showPage("upgrades");if(currentPage!=="missions"&&e.key==="m")showPage("missions");if(currentPage!=="achievements"&&e.key==="a")showPage("achievements");if(currentPage!=="collection"&&e.key==="c")showPage("collection");if(currentPage!=="leaderboard"&&e.key==="l")showPage("leaderboard");if(document.activeElement.tagName==="INPUT")e.preventDefault()}));if(!localStorage.backupid||localStorage.backupid===localStorage._cbid){localStorage.backup=localStorage.localsave;localStorage._cbid=Math.random();localStorage.backupid=localStorage._cbid}